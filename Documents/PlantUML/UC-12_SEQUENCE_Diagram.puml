@startuml
title UC-12: Confirm Appointment - Sequence Diagram

actor "Pet Owner" as owner
participant "User Interface (UI)" as ui
box "App Core" #LightYellow
  participant "Appointment Controller" as appCtrl
  participant "Notification Service" as notifService
end box
box "API Server" #LightGreen
  participant "Appointment Service" as appService
  participant "Pet Sitter Service" as sitterService
end box
database "Database" as db

owner -> ui: Access appointment details
activate ui

ui -> appCtrl: Request appointment details
activate appCtrl

appCtrl -> appService: API request for appointment details
activate appService

appService -> db: Retrieve appointment details
activate db

db --> appService: Return appointment details
deactivate db

appService --> appCtrl: Return appointment details
deactivate appService

appCtrl --> ui: Display appointment details
deactivate appCtrl

owner -> ui: Review appointment details

group Confirm Appointment
    owner -> ui: Confirm appointment
    activate ui

    ui -> appCtrl: Confirm appointment request
    activate appCtrl

    appCtrl -> appService: API request to confirm appointment
    activate appService

    appService -> db: Update appointment status to confirmed
    activate db

    db --> appService: Appointment confirmation status
    deactivate db

    appService --> appCtrl: Return appointment confirmation status
    deactivate appService

    appCtrl -> notifService: Notify Pet Sitter of confirmed appointment
    activate notifService

    notifService -> sitterService: API request to send notification to Pet Sitter
    activate sitterService

    sitterService --> notifService: Return notification status
    deactivate sitterService

    notifService --> appCtrl: Return notification status
    deactivate notifService

    appCtrl --> ui: Display appointment confirmation
    deactivate appCtrl
end group

group Handle Confirmation
    owner -> ui: Verify confirmation
    activate ui

    ui -> appCtrl: Verify confirmation request
    activate appCtrl

    appCtrl -> appService: API request for confirmation status
    activate appService

    appService -> db: Retrieve confirmation status
    activate db

    db --> appService: Return confirmation status
    deactivate db

    appService --> appCtrl: Return confirmation status
    deactivate appService

    appCtrl --> ui: Display confirmation status
    deactivate appCtrl
    deactivate ui
end group

@enduml


